Namespace(batch_norm=0, batch_size=1000, bin_time=0, data_repository_root='data', dataset='icews14', debug=0, dump_t_scores=None, eval_batch_size=500, eval_every_x_mini_batches=100, expand_mode='None', filter_method='time-str', flag_add_reverse=1, flag_additional_filter=0, flag_time_smooth=0, gradient_clip=None, hooks=[], learning_rate=0.1, loss='crossentropy_loss_AllNeg', max_epochs=250, message=None, mode='train', model='TimePlex_base', model_arguments={'embedding_dim': 200, 'srt_wt': 5.0, 'ort_wt': 5.0, 'sot_wt': 5.0, 'time_reg_wt': 1.0, 'emb_reg_wt': 0.005}, model_type='custom', negative_sample_count=0, oov_entity=1, optimizer='Adagrad', patience=3, perturb_time=0, predict_rel=0, predict_time=0, regularization_coefficient=1.0, regularizer=2.0, resume_from_save=None, save_dir='./models/icews14_timeplex_base', save_text=None, save_time_results=None, subset=1, tflogs_dir='./models/icews14_timeplex_base', time_loss_margin=5.0, time_neg_samples=0, time_prediction_method='greedy-coalescing', use_time_facts=0, verbose=0)
User Message::  None
Command::  main.py -d icews14 -m TimePlex_base -a {"embedding_dim":200, "srt_wt": 5.0, "ort_wt": 5.0, "sot_wt": 5.0, "time_reg_wt":1.0, "emb_reg_wt":0.005} -l crossentropy_loss_AllNeg -r 0.1 -b 1000 -x 2000 -n 0 -v 1 -q 0 -y 500 -g_reg 2 -g 1.0 --filter_method time-str -e 250 --flag_add_reverse 1 --save_dir icews14_timeplex_base -x 100
Flag: use_time_tokenizer- False
Flag: flag_add_reverse- 1
Flag: use_time_interval False
KB ./data/icews14/train.txt True
Data Size: ./data/icews14/train.txt (72826, 9)
KB ./data/icews14/test.txt 0
Data Size: ./data/icews14/test.txt (8963, 9)
KB ./data/icews14/valid.txt 0
Data Size: ./data/icews14/valid.txt (8941, 9)
KB data/icews14/train.txt True
Data Size: data/icews14/train.txt (72826, 9)
KB data/icews14/test.txt 0
Data Size: data/icews14/test.txt (8963, 9)
KB data/icews14/valid.txt 0
Data Size: data/icews14/valid.txt (8941, 9)
Train (no expansion) (72826, 9)
Test (8963, 9)
Valid (8941, 9)
Number of timestamps:  365
[(755645, 358), (755646, 359), (755647, 360), (755648, 361), (755649, 362), (755650, 363), (755651, 364), (755652, 365), (755653, 366), ('UNK-TIME', 367)]
Using reg  2.0
final model arguments {'embedding_dim': 200, 'srt_wt': 5.0, 'ort_wt': 5.0, 'sot_wt': 5.0, 'time_reg_wt': 1.0, 'emb_reg_wt': 0.005, 'entity_count': 6870, 'timeInterval_count': 365, 'reg': 2.0, 'relation_count': 460, 'flag_add_reverse': 1, 'batch_norm': 0}
Regularization value: in time_complex_fast:  2.0
batch_norm not being used
Not expanding training data
Train (after expansion) (72826, 9)
building all known database from joint kb
Applying filter- time-str
If using additional filter- 0
converting to lists
done
building all known database from joint kb
Applying filter- time-str
If using additional filter- 0
converting to lists
done
Using regularization_coefficient[: 1.0
max_mini_batch_count: 18206, eval_batch_size 500
Starting training
Mini Batches     1 or   0.0 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   9.3987 | reg  0.564 | time      2 ||Mini Batches     2 or   0.0 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss  10.6468 | reg  1.816 | time      4 ||Mini Batches     3 or   0.0 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss  10.2140 | reg  1.519 | time      6 ||Mini Batches     4 or   0.0 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   8.9168 | reg  0.646 | time      7 ||Mini Batches     5 or   0.1 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   9.4927 | reg  0.555 | time      9 ||
Mini Batches     6 or   0.1 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   7.7871 | reg  0.554 | time     11 ||Mini Batches     7 or   0.1 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   7.4554 | reg  0.566 | time     13 ||Mini Batches     8 or   0.1 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   7.3150 | reg  0.578 | time     14 ||Mini Batches     9 or   0.1 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   7.0315 | reg  0.585 | time     16 ||Mini Batches    10 or   0.1 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   7.2499 | reg  0.580 | time     18 ||
Mini Batches    11 or   0.1 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   6.5514 | reg  0.586 | time     20 ||Mini Batches    12 or   0.2 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   6.3857 | reg  0.582 | time     22 ||Mini Batches    13 or   0.2 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   6.3308 | reg  0.587 | time     24 ||Mini Batches    14 or   0.2 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   6.1735 | reg  0.589 | time     26 ||Mini Batches    15 or   0.2 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   6.2832 | reg  0.593 | time     28 ||
Mini Batches    16 or   0.2 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   5.8397 | reg  0.589 | time     30 ||Mini Batches    17 or   0.2 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   5.8540 | reg  0.588 | time     31 ||Mini Batches    18 or   0.2 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   5.6587 | reg  0.590 | time     33 ||Mini Batches    19 or   0.2 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   5.5590 | reg  0.595 | time     35 ||Mini Batches    20 or   0.3 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   5.6873 | reg  0.592 | time     37 ||
Mini Batches    21 or   0.3 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   5.4460 | reg  0.598 | time     39 ||Mini Batches    22 or   0.3 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   5.4248 | reg  0.601 | time     41 ||Mini Batches    23 or   0.3 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   5.3259 | reg  0.601 | time     43 ||Mini Batches    24 or   0.3 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   5.3254 | reg  0.599 | time     45 ||Mini Batches    25 or   0.3 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   5.3784 | reg  0.604 | time     47 ||
Mini Batches    26 or   0.3 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   5.0298 | reg  0.602 | time     48 ||Mini Batches    27 or   0.4 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   4.9408 | reg  0.603 | time     50 ||Mini Batches    28 or   0.4 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   4.9609 | reg  0.606 | time     52 ||Mini Batches    29 or   0.4 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   4.9272 | reg  0.608 | time     54 ||Mini Batches    30 or   0.4 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   4.9147 | reg  0.610 | time     56 ||
Mini Batches    31 or   0.4 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   4.8274 | reg  0.607 | time     58 ||Mini Batches    32 or   0.4 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   4.7881 | reg  0.611 | time     60 ||Mini Batches    33 or   0.4 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   4.6845 | reg  0.612 | time     61 ||Mini Batches    34 or   0.5 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   4.8590 | reg  0.617 | time     63 ||Mini Batches    35 or   0.5 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   4.7577 | reg  0.616 | time     65 ||
Mini Batches    36 or   0.5 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   4.4869 | reg  0.618 | time     67 ||Mini Batches    37 or   0.5 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   4.4240 | reg  0.620 | time     69 ||Mini Batches    38 or   0.5 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   4.5364 | reg  0.621 | time     71 ||Mini Batches    39 or   0.5 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   4.1990 | reg  0.617 | time     73 ||Mini Batches    40 or   0.5 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   4.4048 | reg  0.626 | time     75 ||
Mini Batches    41 or   0.5 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   4.5499 | reg  0.627 | time     76 ||Mini Batches    42 or   0.6 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   4.5427 | reg  0.631 | time     78 ||Mini Batches    43 or   0.6 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   4.5231 | reg  0.636 | time     80 ||Mini Batches    44 or   0.6 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   4.2164 | reg  0.630 | time     82 ||Mini Batches    45 or   0.6 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   4.4137 | reg  0.632 | time     84 ||
Mini Batches    46 or   0.6 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   4.1509 | reg  0.637 | time     86 ||Mini Batches    47 or   0.6 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   4.1028 | reg  0.636 | time     87 ||Mini Batches    48 or   0.6 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   4.0272 | reg  0.634 | time     89 ||Mini Batches    49 or   0.7 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   4.0412 | reg  0.632 | time     91 ||Mini Batches    50 or   0.7 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   4.0783 | reg  0.634 | time     93 ||
Mini Batches    51 or   0.7 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.9883 | reg  0.628 | time     95 ||Mini Batches    52 or   0.7 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   4.1699 | reg  0.646 | time     97 ||Mini Batches    53 or   0.7 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.8705 | reg  0.638 | time     98 ||Mini Batches    54 or   0.7 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.9577 | reg  0.644 | time    100 ||Mini Batches    55 or   0.7 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.9833 | reg  0.646 | time    102 ||
Mini Batches    56 or   0.8 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   4.0387 | reg  0.647 | time    104 ||Mini Batches    57 or   0.8 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.9037 | reg  0.647 | time    106 ||Mini Batches    58 or   0.8 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.9994 | reg  0.651 | time    107 ||Mini Batches    59 or   0.8 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.8916 | reg  0.648 | time    109 ||Mini Batches    60 or   0.8 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.9301 | reg  0.650 | time    111 ||
Mini Batches    61 or   0.8 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.8538 | reg  0.652 | time    113 ||Mini Batches    62 or   0.8 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.8590 | reg  0.653 | time    114 ||Mini Batches    63 or   0.9 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.6236 | reg  0.652 | time    116 ||Mini Batches    64 or   0.9 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.8588 | reg  0.661 | time    118 ||Mini Batches    65 or   0.9 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.7879 | reg  0.661 | time    120 ||
Mini Batches    66 or   0.9 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.8429 | reg  0.665 | time    122 ||Mini Batches    67 or   0.9 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.6546 | reg  0.658 | time    123 ||Mini Batches    68 or   0.9 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.6711 | reg  0.658 | time    125 ||Mini Batches    69 or   0.9 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.6601 | reg  0.665 | time    127 ||Mini Batches    70 or   0.9 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.6905 | reg  0.667 | time    129 ||
Mini Batches    71 or   1.0 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.2476 | reg  0.662 | time    131 ||Mini Batches    72 or   1.0 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.6060 | reg  0.673 | time    133 ||Mini Batches    73 or   1.0 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.5664 | reg  0.671 | time    135 ||Mini Batches    74 or   1.0 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.3687 | reg  0.670 | time    137 ||Mini Batches    75 or   1.0 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.4520 | reg  0.673 | time    139 ||
Mini Batches    76 or   1.0 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.4552 | reg  0.674 | time    141 ||Mini Batches    77 or   1.0 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.4163 | reg  0.672 | time    143 ||Mini Batches    78 or   1.1 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.4803 | reg  0.683 | time    144 ||Mini Batches    79 or   1.1 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.4214 | reg  0.679 | time    146 ||Mini Batches    80 or   1.1 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.4448 | reg  0.680 | time    148 ||
Mini Batches    81 or   1.1 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.4495 | reg  0.680 | time    150 ||Mini Batches    82 or   1.1 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.3954 | reg  0.680 | time    152 ||Mini Batches    83 or   1.1 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.2769 | reg  0.683 | time    154 ||Mini Batches    84 or   1.1 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.2658 | reg  0.679 | time    155 ||Mini Batches    85 or   1.2 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.3593 | reg  0.688 | time    157 ||
Mini Batches    86 or   1.2 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.1347 | reg  0.685 | time    159 ||Mini Batches    87 or   1.2 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.2871 | reg  0.686 | time    161 ||Mini Batches    88 or   1.2 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.2919 | reg  0.693 | time    163 ||Mini Batches    89 or   1.2 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.3928 | reg  0.685 | time    165 ||Mini Batches    90 or   1.2 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.2796 | reg  0.686 | time    167 ||
Mini Batches    91 or   1.2 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.1655 | reg  0.685 | time    169 ||Mini Batches    92 or   1.2 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.2797 | reg  0.697 | time    170 ||Mini Batches    93 or   1.3 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.2672 | reg  0.689 | time    172 ||Mini Batches    94 or   1.3 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.0676 | reg  0.691 | time    174 ||Mini Batches    95 or   1.3 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.1607 | reg  0.691 | time    176 ||
Mini Batches    96 or   1.3 epochs |[1;34m****------------------[0;0m|  20.0% | Current Loss   3.2115 | reg  0.695 | time    178 ||Mini Batches    97 or   1.3 epochs |[1;34m********--------------[0;0m|  40.0% | Current Loss   3.1005 | reg  0.697 | time    180 ||Mini Batches    98 or   1.3 epochs |[1;34m*************---------[0;0m|  60.0% | Current Loss   3.0062 | reg  0.697 | time    182 ||Mini Batches    99 or   1.3 epochs |[1;34m*****************-----[0;0m|  80.0% | Current Loss   3.0699 | reg  0.699 | time    184 ||Mini Batches   100 or   1.4 epochs |[1;34m**********************[0;0m| 100.0% | Average Loss   3.0841 | reg  0.699 | time    186 ||
Traceback (most recent call last):
  File "main.py", line 501, in <module>
    arguments.save_text, arguments.save_time_results, arguments.patience, arguments.flag_add_reverse)
  File "main.py", line 256, in main
    tr.start(max_mini_batch_count, [eval_every_x_mini_batches // 20, 20], mb_start, tflogs_dir,
  File "/Users/pjx/Documents/git/tkbi/trainer.py", line 385, in start
    flag_add_reverse=self.flag_add_reverse)
  File "/Users/pjx/Documents/git/tkbi/evaluate.py", line 1114, in evaluate
    (rem[s_val], rrm[r_val], rem[o_val], rtm[t_ids[i].item()]))
ValueError: only one element tensors can be converted to Python scalars
